<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CodeChef VC</title>
</head>

<body>
    <h1> CodeChef Virtual Contest App</h1>
    <h3>Contest List fetched!</h3>
    <!-- <ul>
        
    </ul> -->
    <div style="text-align:center;">
        <input type="button" id="first" onclick="firstPage()" value="first" />
        <input type="button" id="next" onclick="nextPage()" value="next" />
        <input type="button" id="previous" onclick="previousPage()" value="previous" />
        <input type="button" id="last" onclick="lastPage()" value="last" />
    
        <div id="list"></div>
    </div>
</body>
<script type="text/javascript">
    var list = new Array();
    var attemptedlist = new Array();
    var pageList = new Array();
    var currentPage = 1;
    var numberPerPage = 10;
    var numberOfPages = 0;
    function checkattempted(code){
        if(code in attemptedlist){
            return true;
        }else{
            return false;
        }
    }
    
    function getNumberOfPages() {
        return Math.ceil(list.length / numberPerPage);
    }

    function nextPage() {
        currentPage += 1;
        loadList();
    }

    function previousPage() {
        currentPage -= 1;
        loadList();
    }

    function firstPage() {
        currentPage = 1;
        loadList();
    }

    function lastPage() {
        currentPage = numberOfPages;
        loadList();
    }

    function loadList() {
        var begin = ((currentPage - 1) * numberPerPage);
        var end = begin + numberPerPage;

        pageList = list.slice(begin, end);
        drawList();
        check();
    }
        
    function drawList() {
        document.getElementById("list").innerHTML = "";
        for (r = 0; r < pageList.length; r++) {
            if(checkattempted(pageList[r].code))
            document.getElementById("list").innerHTML += "<span style='color: red;'>"+pageList[r].code +"</span>"  + "<br/>";
            else{
                document.getElementById("list").innerHTML += pageList[r].code  + "<br/>";   
            }
        }
    }

    function check() {
        document.getElementById("next").disabled = currentPage == numberOfPages ? true : false;
        document.getElementById("previous").disabled = currentPage == 1 ? true : false;
        document.getElementById("first").disabled = currentPage == 1 ? true : false;
        document.getElementById("last").disabled = currentPage == numberOfPages ? true : false;
    }
    function load() {
            loadList();
    }
   window.onload = async function(){
        var contestList = await (await fetch('/getContestList')).json(); 
        console.log(contestList);
        list = contestList.contestList;
        attemptedlist = contestList.attemptedContest;
        console.log(list);
        console.log(attemptedlist);
        load();
   }

</script>
</html>